<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cuit.hyl.graduation.project_ui.dao.BasicInfoDao">

    <resultMap type="cuit.hyl.graduation.project_ui.entity.vo.InitInfo" id="InitInfoMap">
        <result property="id" column="ID" jdbcType="INTEGER"/>
        <result property="name" column="NAME" jdbcType="VARCHAR"/>
        <result property="nickName" column="NICK_NAME" jdbcType="VARCHAR"/>
        <result property="avatatUrl" column="AVATAT_URL" jdbcType="VARCHAR"/>
        <result property="blog" column="BLOG" jdbcType="VARCHAR"/>
        <result property="icon" column="ICON" jdbcType="VARCHAR"/>
    </resultMap>

    <resultMap type="cuit.hyl.graduation.project_ui.entity.School" id="SchoolMap">
        <result property="id" column="ID" jdbcType="INTEGER"/>
        <result property="name" column="NAME" jdbcType="VARCHAR"/>
        <result property="code" column="CODE" jdbcType="INTEGER"/>
        <result property="address" column="ADDRESS" jdbcType="VARCHAR"/>
        <result property="icon" column="ICON" jdbcType="VARCHAR"/>
    </resultMap>

    <resultMap type="cuit.hyl.graduation.project_ui.entity.BasicInfo" id="BasicInfoMap">
        <result property="id" column="ID" jdbcType="INTEGER"/>
        <result property="name" column="NAME" jdbcType="VARCHAR"/>
        <result property="nickName" column="NICK_NAME" jdbcType="VARCHAR"/>
        <result property="sex" column="SEX" jdbcType="INTEGER"/>
        <result property="birthday" column="BIRTHDAY" jdbcType="DATE"/>
        <result property="politicalStatus" column="POLITICAL_STATUS" jdbcType="VARCHAR"/>
        <result property="age" column="AGE" jdbcType="INTEGER"/>
        <result property="hometown" column="HOMETOWN" jdbcType="VARCHAR"/>
        <result property="avatatUrl" column="AVATAT_URL" jdbcType="VARCHAR"/>
        <result property="phone" column="PHONE" jdbcType="VARCHAR"/>
        <result property="fax" column="FAX" jdbcType="VARCHAR"/>
        <result property="email" column="EMAIL" jdbcType="VARCHAR"/>
        <result property="qq" column="QQ" jdbcType="VARCHAR"/>
        <result property="wechat" column="WECHAT" jdbcType="VARCHAR"/>
        <result property="blog" column="BLOG" jdbcType="VARCHAR"/>
        <result property="postCode" column="POST_CODE" jdbcType="VARCHAR"/>
        <result property="address" column="ADDRESS" jdbcType="VARCHAR"/>
        <result property="department" column="DEPARTMENT" jdbcType="VARCHAR"/>
        <result property="degree" column="DEGREE" jdbcType="VARCHAR"/>
        <result property="subject" column="SUBJECT" jdbcType="VARCHAR"/>
        <result property="position" column="POSITION" jdbcType="VARCHAR"/>
        <result property="jobTitle" column="JOB_TITLE" jdbcType="VARCHAR"/>
        <result property="introduction" column="INTRODUCTION" jdbcType="OTHER"/>
        <result property="researchAreas" column="RESEARCH_AREAS" jdbcType="OTHER"/>
        <result property="unitId" column="UNIT_ID" jdbcType="INTEGER"/>
        <result property="schoolId" column="SCHOOL_ID" jdbcType="INTEGER"/>
        <result property="peopleId" column="PEOPLE_ID" jdbcType="INTEGER"/>
    </resultMap>

    <!--通过用户id 查询-->
    <select id="queryByPeopleId" resultMap="BasicInfoMap">
        select
          ID, NAME, NICK_NAME, SEX, BIRTHDAY, POLITICAL_STATUS, AGE, HOMETOWN, AVATAT_URL, PHONE, FAX, EMAIL, QQ, WECHAT, BLOG, POST_CODE, ADDRESS, DEPARTMENT, DEGREE, SUBJECT, POSITION, JOB_TITLE, INTRODUCTION, RESEARCH_AREAS, UNIT_ID, SCHOOL_ID, PEOPLE_ID
        from graduation_ui.basic_info
        where PEOPLE_ID = #{id}
        order by TIME desc
    </select>

    <!--通过用户id 查询初始化信息-->
    <select id="queryInitInfo" resultMap="InitInfoMap">
        SELECT
            BI.ID,
            BI.NAME,
            BI.NICK_NAME,
            BI.AVATAT_URL,
            BI.BLOG,
            S.ICON
        FROM
            graduation_ui.basic_info AS BI
            LEFT JOIN graduation_ui.school AS S
            ON BI.SCHOOL_ID = S.id
        WHERE
            PEOPLE_ID = #{id}
        order by TIME desc
    </select>

    <insert id="easyPoiExcelImport">
        INSERT INTO graduation_ui.basic_info (ID,NAME,NICK_NAME,SEX,BIRTHDAY,POLITICAL_STATUS,AGE,HOMETOWN,AVATAT_URL,PHONE,FAX,EMAIL,QQ,WECHAT,BLOG,POST_CODE,ADDRESS,DEPARTMENT,DEGREE,SUBJECT,POSITION,JOB_TITLE,INTRODUCTION,RESEARCH_AREAS,UNIT_ID,SCHOOL_ID,PEOPLE_ID)
        VALUES
        <foreach collection="list" item="basicInfo" separator=",">
            (#{basicInfo.id},#{basicInfo.name},#{basicInfo.nickName},#{basicInfo.sex},#{basicInfo.birthday},#{basicInfo.politicalStatus},
            #{basicInfo.age},#{basicInfo.hometown},#{basicInfo.avatatUrl},#{basicInfo.phone},#{basicInfo.fax},#{basicInfo.email},
            #{basicInfo.qq},#{basicInfo.wechat},#{basicInfo.blog},#{basicInfo.postCode},#{basicInfo.address},#{basicInfo.department},
            #{basicInfo.degree},#{basicInfo.subject},#{basicInfo.position},#{basicInfo.jobTitle},#{basicInfo.introduction},#{basicInfo.researchAreas},
            #{basicInfo.unitId},#{basicInfo.schoolId},#{basicInfo.peopleId})
        </foreach>
    </insert>

    <!--头像更新-->
    <insert id="updateAvatar">
        UPDATE graduation_ui.basic_info
        SET AVATAT_URL = #{avatar}
        WHERE
            ID = #{id}
    </insert>

    <!-- -&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-->
    <!--查询学校信息-->
    <select id="schoolInfo" resultMap="SchoolMap">
        SELECT
            s.`NAME`,
            s.ADDRESS,
            s.`CODE`,
            s.ICON
        FROM
            graduation_ui.school AS s
                LEFT JOIN basic_info AS bi ON s.`CODE` = bi.SCHOOL_ID
        WHERE
            bi.ID = #{id}
    </select>


</mapper>